Alembic Database Migration Tool
================================

이 디렉토리는 Alembic을 사용한 데이터베이스 스키마 버전 관리를 위한 것입니다.

## 마이그레이션 생성

```bash
# 자동으로 모델 변경사항 감지하여 마이그레이션 생성
alembic revision --autogenerate -m "설명"

# 빈 마이그레이션 파일 생성 (수동 작성)
alembic revision -m "설명"
```

## 마이그레이션 실행

```bash
# 최신 버전으로 업그레이드
alembic upgrade head

# 특정 버전으로 업그레이드
alembic upgrade <revision>

# 한 단계 업그레이드
alembic upgrade +1

# 한 단계 다운그레이드
alembic downgrade -1

# 특정 버전으로 다운그레이드
alembic downgrade <revision>
```

## 마이그레이션 정보 확인

```bash
# 현재 버전 확인
alembic current

# 마이그레이션 히스토리 확인
alembic history

# 적용되지 않은 마이그레이션 확인
alembic heads
```

## Docker 환경에서 실행

```bash
# 컨테이너 내부에서 실행
docker-compose exec kanban alembic upgrade head

# 새 마이그레이션 생성
docker-compose exec kanban alembic revision --autogenerate -m "설명"
```

## Kubernetes Job으로 실행

```yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: kanban-migration
spec:
  template:
    spec:
      containers:
      - name: migration
        image: kanban-api:latest
        command: ["alembic", "upgrade", "head"]
      restartPolicy: OnFailure
```
